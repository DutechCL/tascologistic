import{y as T,e as _,o as c,k as y,w as d,h as p,t as C,a,u as e,p as P,c as k,l as S,F as I,s as w,m as B,i as E,v as R}from"./index-1cda9ed7.js";import{s as l,b as N,a as x}from"./tag.esm-31fe6e2d.js";import{u as $}from"./OrdersApiService-79812004.js";import{c as D}from"./ToastMixin-c8da1883.js";import{_ as L}from"./FilterMultiSelect-6b8c9f5d.js";const O=$(),H=T("ordersBills",{state:()=>({listOrders:[],order:[],visibleDialog:!1}),getters:{orders:s=>s.listOrders},actions:{async getOrdersBillPickupAndHere(){let s=await O.getOrdersBillPickupAndHere();this.listOrders=s.data},async getOrdersBillDelivery(){let s=await O.getOrdersBillDelivery();this.listOrders=s.data},async generateDocument(s){let i=await O.generateDocument(s);return i.data.order_status_id===D.ORDER_STATUS_BILLED?this.listOrders=this.listOrders.filter(t=>t.id!==i.data.id):this.listOrders=this.listOrders.map(t=>t.id===i.data.id?i.data:t),i},showDetailOrder(s){this.order=s,this.visibleDialog=!0}}}),M=p("h1",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"},[p("i",{class:"pi pi-eye !text-xl"}),E(" Ver detalles ")],-1),V=p("div",{class:"mt-2 mb-1 text-primary-900 font-semi-bold"},[p("p",null,"Productos")],-1),Q={__name:"DialogDetail",setup(s){var f;const i=H(),t=_(i.order),u=_((f=i.order)==null?void 0:f.OrderItems),b=v=>{switch(v.pivot.task){case"reviewer":return"Revisado por:";case"picker":return"Preparado por";case"cda":return"Autorizado por"}};return(v,m)=>(c(),y(e(B),{modal:"",header:" ",maximizable:"",style:{width:"70vw"}},{default:d(()=>[p("div",null,[M,p("p",null,"Revisa aquí los detalles de la nota de venta N° "+C(t.value.DocNum),1)]),V,a(e(N),{tableStyle:"min-width: 50rem",filters:"filters",value:u.value},{default:d(()=>[a(e(l),{headerClass:"!bg-primary-900",field:"date",header:"Cantidad"},{body:d(o=>[p("p",null,C(o.data.Quantity)+" Unidades",1)]),_:1}),a(e(l),{headerClass:"!bg-primary-900",field:"ItemCode",header:"SKU"}),a(e(l),{headerClass:"!bg-primary-900",field:"ItemDescription",header:"Producto"})]),_:1},8,["value"]),a(e(N),{class:"pt-5",tableStyle:"min-width: 50rem",value:[t.value]},{default:d(()=>[a(e(l),{headerClass:"!bg-primary-900",field:"SalesEmployeeName",header:"Vendedor"},{body:d(o=>{var r,h;return[(r=o.data)!=null&&r.SalesEmployeeName?(c(),y(e(x),{key:0,icon:"pi pi-user",value:(h=o.data)==null?void 0:h.SalesEmployeeName,class:"p-tag-1 tag-font-method tag-radius"},null,8,["value"])):P("",!0)]}),_:1}),(c(!0),k(I,null,S(t.value.Responsibles,o=>(c(),y(e(l),{headerClass:"!bg-primary-900",field:"responsible",header:b(o)},{body:d(r=>[o.name?(c(),y(e(x),{key:0,icon:"pi pi-user",value:o.name,class:"p-tag-1 tag-font-method tag-radius"},null,8,["value"])):P("",!0)]),_:2},1032,["header"]))),256))]),_:1},8,["value"]),a(e(w),{label:"Cerrar",onClick:m[0]||(m[0]=o=>e(i).visibleDialog=!1),class:"!py-2 !border-none !px-10 !bg-primary-900 float-right mt-5"})]),_:1}))}};const F={key:0},A={class:"flex"},Y={__name:"DataTableOrders",props:{type:String,actions:Object,orders:Object},setup(s,{emit:i}){const t=s,u=_(t.orders),b=_(t.orders),f=_(["DocNum","Customer","DocTotal","DocTime","DocDate"]),v=r=>{switch(r.method_shipping_id){case D.METHOD_SHIPPING_DELIVERY_ID:return"pi pi-truck";case D.METHOD_SHIPPING_PICKUP_ID:return"pi pi-home";case D.METHOD_SHIPPING_HERE_ID:return"pi pi-shopping-cart";default:return"pi pi-shopping-cart"}},m=(r,h,n=null)=>{i("action",{method:r,document:n,order:h})},o=r=>{u.value=r.orders};return R(()=>t.orders,r=>{u.value=r,b.value=r}),(r,h)=>u.value.length>0?(c(),k("div",F,[p("div",A,[a(L,{typeOrders:"here",allOrders:b.value,filters:f.value,onFilter:o},null,8,["allOrders","filters"])]),a(e(N),{tableStyle:"min-width: 50rem",filters:"filters",value:u.value,paginator:"",rowsPerPageOptions:[5,10,20,50],rows:5,dataKey:"id",filterDisplay:"row",loading:r.loading,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} a {last} de {totalRecords}"},{default:d(()=>[a(e(l),{headerClass:"!bg-primary-900",sortable:"",field:"DocNum",header:"Nota de venta"},{body:d(n=>[E(" N° "+C(n.data.DocNum),1)]),_:1}),a(e(l),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(l),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente",style:{"max-width":"300px"}}),a(e(l),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(l),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:d(n=>[a(e(x),{icon:v(n.data),value:n.data.MethodShippingName,class:"p-tag-1 tag-font-method tag-radius"},null,8,["icon","value"])]),_:1}),a(e(l),{headerClass:"!bg-primary-900",field:"note",header:"Detalles"},{body:d(n=>[a(e(w),{icon:"pi pi-eye",onClick:g=>m("showDetailOrder",n.data),class:"!text-primary-900",label:"Ver detalles",link:""},null,8,["onClick"])]),_:1}),a(e(l),{headerClass:"!bg-primary-900",field:"client",header:"Emitir"},{body:d(n=>[(c(!0),k(I,null,S(t.actions,g=>(c(),y(e(w),{label:g.label,disabled:!g.active,onClick:U=>m(g.method,n.data,g.document),class:"!py-1.5 !border-primary-900 !text-primary-900 mr-3",severity:"primary",outlined:""},null,8,["label","disabled","onClick"]))),256))]),_:1})]),_:1},8,["value","loading"])])):P("",!0)}};export{Y as _,Q as a,H as u};

import{y as I,e as g,o as u,k as b,w as n,h as c,t as O,a,u as e,p as C,c as N,l as E,F as B,s as w,m as T,i as S,v as R}from"./index-76695505.js";import{s as i,b as P,a as k}from"./tag.esm-79cf50c2.js";import{u as $}from"./OrdersApiService-bd3c85de.js";import{c as v}from"./ToastMixin-90d9c26e.js";import{_ as L}from"./FilterMultiSelect-af447170.js";const D=$(),H=I("ordersBills",{state:()=>({listOrders:[],order:[],visibleDialog:!1}),getters:{orders:t=>t.listOrders},actions:{async getOrdersBillPickupAndHere(){let t=await D.getOrdersBillPickupAndHere();this.listOrders=t.data},async getOrdersBillDelivery(){let t=await D.getOrdersBillDelivery();this.listOrders=t.data},async generateDocument(t){let o=await D.generateDocument(t);return o.data.order_status_id===v.ORDER_STATUS_BILLED?this.listOrders=this.listOrders.filter(s=>s.id!==o.data.id):this.listOrders=this.listOrders.map(s=>s.id===o.data.id?o.data:s),o},showDetailOrder(t){this.order=t,this.visibleDialog=!0}}}),M=c("h1",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"},[c("i",{class:"pi pi-eye !text-xl"}),S(" Ver detalles ")],-1),V=c("div",{class:"mt-2 mb-1 text-primary-900 font-semi-bold"},[c("p",null,"Productos")],-1),q={__name:"DialogDetail",setup(t){var y;const o=H(),s=g(o.order),p=g((y=o.order)==null?void 0:y.OrderItems),_=f=>{switch(f.pivot.task){case"reviewer":return"Revisado por:";case"picker":return"Preparado por";case"cda":return"Autorizado por"}};return(f,m)=>(u(),b(e(T),{modal:"",header:" ",maximizable:"",style:{width:"70vw"}},{default:n(()=>[c("div",null,[M,c("p",null,"Revisa aquí los detalles de la nota de venta N° "+O(s.value.DocNum),1)]),V,a(e(P),{tableStyle:"min-width: 50rem",filters:"filters",value:p.value},{default:n(()=>[a(e(i),{headerClass:"!bg-primary-900",field:"date",header:"Cantidad"},{body:n(d=>[c("p",null,O(d.data.Quantity)+" Unidades",1)]),_:1}),a(e(i),{headerClass:"!bg-primary-900",field:"ItemCode",header:"SKU"}),a(e(i),{headerClass:"!bg-primary-900",field:"ItemDescription",header:"Producto"})]),_:1},8,["value"]),a(e(P),{class:"pt-5",tableStyle:"min-width: 50rem",value:[s.value]},{default:n(()=>[a(e(i),{headerClass:"!bg-primary-900",field:"SalesEmployeeName",header:"Vendedor"},{body:n(d=>{var r,h;return[(r=d.data)!=null&&r.SalesEmployeeName?(u(),b(e(k),{key:0,icon:"pi pi-user",value:(h=d.data)==null?void 0:h.SalesEmployeeName,class:"p-tag-1 tag-font-method tag-radius"},null,8,["value"])):C("",!0)]}),_:1}),(u(!0),N(B,null,E(s.value.Responsibles,d=>(u(),b(e(i),{headerClass:"!bg-primary-900",field:"responsible",header:_(d)},{body:n(r=>[d.name?(u(),b(e(k),{key:0,icon:"pi pi-user",value:d.name,class:"p-tag-1 tag-font-method tag-radius"},null,8,["value"])):C("",!0)]),_:2},1032,["header"]))),256))]),_:1},8,["value"]),a(e(w),{label:"Cerrar",onClick:m[0]||(m[0]=d=>e(o).visibleDialog=!1),class:"!py-2 !border-none !px-10 !bg-primary-900 float-right mt-5"})]),_:1}))}};const F={key:0},U={class:"flex"},Q={__name:"DataTableOrders",props:{type:String,actions:Object,orders:Object},setup(t,{emit:o}){const s=t,p=g(s.orders),_=g(s.orders),y=g(["DocNum","Customer","DocTotal","DocTime","DocDate"]),f=r=>{switch(r.method_shipping_id){case v.METHOD_SHIPPING_DELIVERY_ID:return"pi pi-truck";case v.METHOD_SHIPPING_PICKUP_ID:return"pi pi-home";case v.METHOD_SHIPPING_HERE_ID:return"pi pi-shopping-cart";default:return"pi pi-shopping-cart"}},m=(r,h,l=null)=>{o("action",{method:r,document:l,order:h})},d=r=>{p.value=r.orders};return R(()=>s.orders,r=>{p.value=r,_.value=r}),(r,h)=>p.value.length>0?(u(),N("div",F,[c("div",U,[a(L,{typeOrders:"here",allOrders:_.value,filters:y.value,onFilter:d},null,8,["allOrders","filters"])]),a(e(P),{tableStyle:"min-width: 50rem",filters:"filters",value:p.value,paginator:"",rowsPerPageOptions:[5,10,20,50],rows:5,dataKey:"id",filterDisplay:"row",loading:r.loading,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} a {last} de {totalRecords}"},{default:n(()=>[a(e(i),{headerClass:"!bg-primary-900",sortable:"",field:"DocNum",header:"Nota de venta"},{body:n(l=>[S(" N° "+O(l.data.DocNum),1)]),_:1}),a(e(i),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(i),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente",style:{"max-width":"300px"}}),a(e(i),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(i),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:n(l=>[a(e(k),{icon:f(l.data),value:l.data.MethodShippingName,class:"p-tag-1 tag-font-method tag-radius"},null,8,["icon","value"])]),_:1}),a(e(i),{headerClass:"!bg-primary-900",field:"note",header:"Detalles"},{body:n(l=>[a(e(w),{icon:"pi pi-eye",onClick:x=>m("showDetailOrder",l.data),class:"!text-primary-900",label:"Ver detalles",link:""},null,8,["onClick"])]),_:1}),a(e(i),{headerClass:"!bg-primary-900",field:"client",header:"Emitir"},{body:n(l=>[a(e(w),{label:l.data.U_SBO_FormaPago,onClick:x=>m("generateDocument",l.data,l.data.U_SBO_FormaPago),class:"!py-1.5 !border-primary-900 !text-primary-900 mr-3",severity:"primary",style:{width:"100px"},outlined:""},null,8,["label","onClick"])]),_:1})]),_:1},8,["value","loading"])])):C("",!0)}};export{Q as _,q as a,H as u};

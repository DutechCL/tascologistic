import{s as q,a as te}from"./tabpanel.esm-9203247e.js";import{T as re,C as se,_ as z,c as M,a as G,b as le}from"./FilterMultiSelect-39533e63.js";import{e as f,k as U,l as B,o as n,m as D,w as i,h as t,i as k,t as O,a,u as e,c as C,F as R,p as Q,s as N,q as Y,v as b,x as J,y as L,z as oe}from"./index-193ecf8e.js";import{a as H,b as V,s as r}from"./tag.esm-a3c22367.js";import{u as W}from"./OrdersApiService-9a584736.js";import"./index.esm-3a02ba19.js";import"./index.esm-f527573d.js";const ie=t("h1",{class:"mb-1 text-primary-900 font-inter font-semibold text-xl"},[t("i",{class:"pi pi-eye !text-xl"}),k(" Ver Documentos ")],-1),ne={class:"flex align-center mb-2"},de={class:"text-primary-900"},ce=t("strong",{class:"mr-3 font-semibold"},"Nota de venta N°",-1),ue={class:"mt-5"},pe=t("p",null," 2 archivos adjuntos ",-1),me={class:"flex"},he={class:"mt-2 mr-5 relative",width:"200",height:"180"},be=["src"],_e={class:"bg-gray-100"},ve=t("i",{class:"pi pi-file-pdf m-2",style:{color:"#F40F02"}},null,-1),ge={class:"font-normal text-sm"},fe=["onClick"],X={__name:"DialogDetail",props:{order:Object},setup(v,{emit:g}){const p=v,s=f([]),_=f([{name:"Documento 1",url:"http://ocw.uv.es/ingenieria-y-arquitectura/programacionmultimedia/t2-1-css.pdf"},{name:"Documento 2",url:"http://ocw.uv.es/ingenieria-y-arquitectura/programacionmultimedia/t2-1-css.pdf"}]),h=l=>{window.open(l,"_blank")};U(()=>{s.value=p.order}),B(()=>p.order,l=>{s.value=l});const d=()=>{g("visible",{visibleReport:!1})};return(l,c)=>(n(),D(e(Y),{modal:"",header:" ",style:{width:"70vw"}},{default:i(()=>[t("div",null,[ie,t("div",ne,[t("p",de,[ce,k(O(s.value.DocNum),1)]),a(e(H),{icon:"pi pi-shopping-bag",value:s.value.MethodShippingName,class:"ml-3 tag-radius tag-rounded-blue tag-font-method"},null,8,["value"])]),a(e(H),{icon:"pi pi-user",value:s.value.Customer.CardName,class:"tag-radius tag-rounded-blue tag-font-method"},null,8,["value"]),t("div",ue,[pe,t("div",me,[(n(!0),C(R,null,Q(_.value,o=>(n(),C("div",he,[t("embed",{class:"w-full",src:o.url,type:"application/pdf"},null,8,be),t("div",_e,[ve,t("span",ge,O(o.name),1)]),t("a",{class:"mask-pdf",onClick:y=>h(o.url)},null,8,fe)]))),256))])])]),a(e(N),{label:"Cerrar",onClick:d,class:"!py-2 !border-none !px-10 !bg-primary-900 float-right mt-5"})]),_:1}))}},ye=t("h1",{class:"mb-1 text-primary-900 font-inter font-semibold text-xl"},[t("i",{class:"pi pi-eye !text-xl"}),k(" Ver observaciones ")],-1),De={class:"flex align-center mb-2"},Ce={class:"text-primary-900"},xe=t("strong",{class:"mr-3 font-semibold"},"Nota de venta N°",-1),Ne={class:"mr-3 tag-radius tag-rounded-blue tag-font-method"},Oe=["innerHTML"],Pe={class:"mt-5"},ke=t("strong",null,"NOTA:",-1),$e=["innerHTML"],Z={__name:"DialogDetailObservation",props:{order:String},setup(v,{emit:g}){const p=v,s=f([]);U(()=>{s.value=p.order}),B(()=>p.order,l=>{s.value=l});const _=()=>{g("visible",{visibleReport:!1})},h=l=>new DOMParser().parseFromString(l,"text/html").body.innerText,d=l=>l.replace(/\r/g,"<br>").replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");return(l,c)=>(n(),D(e(Y),{modal:"",header:" ",style:{width:"70vw"}},{default:i(()=>[t("div",null,[ye,t("div",De,[t("p",Ce,[xe,k(O(s.value.DocNum),1)]),a(e(H),{icon:"pi pi-shopping-cart",value:s.value.MethodShippingName,class:"ml-3 tag-radius tag-rounded-blue tag-font-method"},null,8,["value"])]),a(e(H),{icon:"pi pi-user",value:s.value.Customer.CardName,class:"tag-radius tag-rounded-blue tag-font-method mb-5"},null,8,["value"]),s.value.HasProblems?b("",!0):(n(),D(e(V),{key:0,tableStyle:"min-width: 50rem",filters:"filters",value:s.value.OrderItems},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",field:"Quantity",header:"Cantidad"},{body:i(o=>[t("p",null,O(o.data.Quantity)+" Unidad",1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"ItemCode",header:"SKU"}),a(e(r),{headerClass:"!bg-primary-900",field:"ItemDescription",header:"Producto"}),a(e(r),{headerClass:"!bg-primary-900",field:"Problems",header:"Problema"},{body:i(o=>[(n(!0),C(R,null,Q(o.data.Problems,(y,w)=>(n(),C("p",{key:w},[t("span",Ne,O(h(y.ProblemName)),1)]))),128))]),_:1})]),_:1},8,["value"])),t("div",null,[s.value.HasProblems?(n(),D(e(V),{key:0,tableStyle:"min-width: 50rem",filters:"filters",value:s.value.Problems},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",field:"ProblemName",header:"Probelma"},{body:i(o=>[t("p",null,O(o.data.ProblemName),1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"Other",header:"Descripcion"},{body:i(o=>[t("p",{innerHTML:o.data.Other},null,8,Oe)]),_:1})]),_:1},8,["value"])):b("",!0)]),t("div",Pe,[ke,k(),t("span",{innerHTML:d(s.value.Comments)},null,8,$e)])]),a(e(N),{label:"Cerrar",onClick:_,class:"!py-2 !border-none !px-10 !bg-primary-900 float-right mt-5"})]),_:1}))}};function ee(v){const p=f(v.value.filter(c=>c.MethodShippingId===1)),s=f(v.value.filter(c=>c.MethodShippingId!==1)),_=f(s.value),h=f(p.value);B(()=>v.value,c=>{p.value=c.filter(o=>o.MethodShippingId===1).sort((o,y)=>new Date(y.updateApp)-new Date(o.updateApp)),s.value=c.filter(o=>o.MethodShippingId!==1).sort((o,y)=>new Date(y.updated_at)-new Date(o.updated_at)),_.value=s.value,h.value=p.value});const d=c=>{s.value=l(_.value,c),p.value=l(h.value,c)};function l(c,o){return c.filter(y=>y.DocNum.toString().includes(o.value.toString())||y.Customer.CardName.toLowerCase().includes(o.value.toLowerCase()))}return{ordersHere:p,ordersPickupAndDelivery:s,allOrdersPickupAndDelivery:_,allOrdersHere:h,search:d}}function ae(){const v=f(!1),g=f({}),p=f("");return{visible:v,selectedOrder:g,currentDialog:p,openDialog:(h,d)=>{p.value=h,v.value=!0,g.value={...d}},closeDialog:({value:h})=>{h||(g.value={},v.value=v.visible)}}}const Se={class:"flex justify-between"},Me=t("div",null,[t("h1",{class:"mb-2 text-primary-900 font-inter font-semibold text-2xl"}," Notas de venta ")],-1),He={key:0},we=t("h2",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"}," Aquí ",-1),Ie={class:"flex"},Te={key:1},Ee=t("div",null,[t("h2",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"}," Retiro / Despacho ")],-1),Ve={class:"flex"},Ae={key:5,style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},Le=t("h1",{class:"align-center font-inter font-semibold mb-4 text-2xl text-center text-primary-900"}," No se han encontrado ordenes ",-1),Re=[Le],Fe={__name:"ToManage",props:{ListOrders:Array,search:String},setup(v){const g=v,{showToast:p}=re.setup(),{showConfirm:s}=se.setup(),_=W(),{ListOrders:h}=J(g),d=f(!1),{visible:l,selectedOrder:c,currentDialog:o,openDialog:y,closeDialog:w}=ae(),{ordersHere:T,ordersPickupAndDelivery:I,allOrdersPickupAndDelivery:F,allOrdersHere:$,search:E}=ee(h);U(()=>{d.value=!0});const m=P=>{console.log(P),P.type===M.METHOD_SHIPPING_HERE?T.value=P.orders:I.value=P.orders},A=f(!1),K=async(P,S=1)=>{if(await s())try{const x={orderId:P.id,action:S,responsible:M.RESPONSIBLE_CDA,problems:null,other:null,orderItemsProblem:null};let j=await _.processOrderAction(x);p({status:j.status,message:j.message})}catch(x){x.response&&p({status:x.response.data.status,message:x.response.data.message})}else p({status:"info",message:"Proceso cancelado"})};return(P,S)=>(n(),C(R,null,[t("div",Se,[Me,a(z,{onSearch:e(E)},null,8,["onSearch"])]),e(T).length>0?(n(),C("div",He,[we,t("div",Ie,[d.value?(n(),D(G,{key:0,typeOrders:e(M).METHOD_SHIPPING_HERE,allOrders:e($),onFilter:m},null,8,["typeOrders","allOrders"])):b("",!0)]),a(e(V),{onOnPage:P.loadMoreData,class:"mb-20",value:e(T),tableStyle:"min-width: 50rem",filters:"filters",paginator:"",rows:5,dataKey:"id",filterDisplay:"row",loading:A.value},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocNum",header:"Nota de venta"},{body:i(u=>[k(" N° "+O(u.data.DocNum),1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTime",header:"Hora"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:i(u=>[a(e(H),{Tag:"",icon:"pi pi-shopping-cart",value:u.data.MethodShippingName,rounded:"",class:"tag-radius tag-rounded-blue tag-font-method"},null,8,["value"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:" Observación"},{body:i(u=>[a(e(N),{icon:"pi pi-eye",onClick:x=>e(y)("observation",u.data),class:"!font-normal !text-primary-900",label:"Ver observación",link:""},null,8,["onClick"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:""},{body:i(u=>[a(e(N),{onClick:x=>K(u.data),label:"Informado",class:"!py-1.5 !border-primary-900 !text-primary-900",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["onOnPage","value","loading"])])):b("",!0),e(I).length>0?(n(),C("div",Te,[Ee,t("div",Ve,[d.value?(n(),D(G,{key:0,allOrders:e(F),typeOrders:e(M).METHOD_SHIPPING_PICKUP_AND_DELIVERY,onFilter:m},null,8,["allOrders","typeOrders"])):b("",!0)]),a(e(V),{onOnPage:P.loadMoreData,value:e(I),tableStyle:"min-width: 50rem",filters:"filters",paginator:"",rows:5,dataKey:"id",filterDisplay:"row",loading:A.value},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",field:"DocNum",header:"Nota de venta",sortable:""},{body:i(u=>[k(" N° "+O(u.data.DocNum),1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTime",header:"Hora"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:i(u=>[a(e(H),{Tag:"",icon:u.data.MethodShippingId===e(M).METHOD_SHIPPING_PICKUP_ID?"pi pi-home":"pi pi-truck",value:u.data.MethodShippingName,rounded:"",class:"tag-radius tag-rounded-blue tag-font-method"},null,8,["icon","value"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:"Documentos"},{body:i(u=>[a(e(N),{icon:"pi pi-eye",onClick:x=>e(y)("detail",u.data),class:"!font-normal !text-primary-900",label:"Ver documentos",link:""},null,8,["onClick"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:""},{body:i(u=>[a(e(N),{label:"Rechazar",onClick:x=>e(y)("reportProblem",u.data),class:"!py-1.5 mr-3 !border-primary-900 !text-primary-900",outlined:""},null,8,["onClick"]),a(e(N),{label:"Autorizar",onClick:x=>K(u.data,3),class:"!py-1.5 !border-primary-900 !text-primary-900",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["onOnPage","value","loading"])])):b("",!0),e(o)==="detail"?(n(),D(X,{key:2,visible:e(l),"onUpdate:visible":S[0]||(S[0]=u=>L(l)?l.value=u:null),order:e(c),onVisible:e(w)},null,8,["visible","order","onVisible"])):b("",!0),e(o)==="observation"?(n(),D(Z,{key:3,visible:e(l),"onUpdate:visible":S[1]||(S[1]=u=>L(l)?l.value=u:null),order:e(c),onVisible:e(w)},null,8,["visible","order","onVisible"])):b("",!0),e(o)==="reportProblem"?(n(),D(le,{key:4,visible:e(l),"onUpdate:visible":S[2]||(S[2]=u=>L(l)?l.value=u:null),typeProblems:e(M).RESPONSIBLE_CDA,order:e(c),onVisible:e(w)},null,8,["visible","typeProblems","order","onVisible"])):b("",!0),e(T).length===0&&e(I).length===0?(n(),C("div",Ae,Re)):b("",!0)],64))}},Ge={class:"flex justify-between"},Ue=t("div",null,[t("h1",{class:"mb-2 text-primary-900 font-inter font-semibold text-2xl"}," Notas de venta ")],-1),Be={key:0},Ke=t("h2",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"}," Aquí ",-1),je={class:"flex"},qe={key:1},ze=t("div",null,[t("h2",{class:"mb-4 text-primary-900 font-inter font-semibold text-xl"}," Retiro / Despacho ")],-1),Qe={class:"flex"},Ye={key:4,style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},Je=t("h1",{class:"align-center font-inter font-semibold mb-4 text-2xl text-center text-primary-900"}," No se han encontrado ordenes ",-1),We=[Je],Xe={__name:"Managed",props:{ListOrders:Array,search:String},setup(v){const g=v,{ListOrders:p}=J(g),{visible:s,selectedOrder:_,currentDialog:h,openDialog:d,closeDialog:l}=ae(),{ordersHere:c,ordersPickupAndDelivery:o,allOrdersPickupAndDelivery:y,allOrdersHere:w,search:T}=ee(p),I=$=>{$.type===M.METHOD_SHIPPING_HERE?c.value=$.orders:o.value=$.orders},F=f(!1);return($,E)=>(n(),C(R,null,[t("div",Ge,[Ue,a(z,{onSearch:e(T)},null,8,["onSearch"])]),e(c).length>0?(n(),C("div",Be,[Ke,t("div",je,[a(G,{typeOrders:"Here",allOrders:e(w),onFilter:I},null,8,["allOrders"])]),a(e(V),{onOnPage:$.loadMoreData,class:"mb-20",value:e(c),tableStyle:"min-width: 50rem",filters:"filters",paginator:"",rows:5,dataKey:"id",filterDisplay:"row",loading:F.value},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",field:"DocNum",header:"Nota de venta"},{body:i(m=>[k(" N° "+O(m.data.DocNum),1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTime",header:"Hora"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:i(m=>[a(e(H),{Tag:"",icon:"pi pi-shopping-cart",value:m.data.MethodShippingName,rounded:"",class:"tag-radius tag-rounded-blue tag-font-method"},null,8,["value"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:"Observación"},{body:i(m=>[a(e(N),{icon:"pi pi-eye",onClick:A=>e(d)("observation",m.data),class:"!font-normal !text-primary-900",label:"Ver observación",link:""},null,8,["onClick"])]),_:1})]),_:1},8,["onOnPage","value","loading"])])):b("",!0),e(o).length>0?(n(),C("div",qe,[ze,t("div",Qe,[a(G,{typeOrders:e(M).METHOD_SHIPPING_PICKUP_AND_DELIVERY,allOrders:e(y),onFilter:I},null,8,["typeOrders","allOrders"])]),a(e(V),{onOnPage:$.loadMoreData,value:e(o),tableStyle:"min-width: 50rem",filters:"filters",paginator:"",rows:5,dataKey:"id",filterDisplay:"row",loading:F.value},{default:i(()=>[a(e(r),{headerClass:"!bg-primary-900",field:"DocNum",header:"Nota de venta"},{body:i(m=>[k(" N° "+O(m.data.DocNum),1)]),_:1}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocDate",header:"Fecha"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTime",header:"Hora"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"Customer.CardName",header:"Cliente"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"DocTotal",header:"Monto total"}),a(e(r),{headerClass:"!bg-primary-900",sortable:"",field:"MethodShippingName",header:"Método entrega"},{body:i(m=>[a(e(H),{Tag:"",icon:"pi pi-shopping-cart",value:m.data.MethodShippingName,rounded:"",class:"tag-radius tag-rounded-blue tag-font-method"},null,8,["value"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:"Documentos"},{body:i(m=>[a(e(N),{icon:"pi pi-eye",onClick:A=>e(d)("detail",m.data),class:"!font-normal !text-primary-900",label:"Ver documentos",link:""},null,8,["onClick"])]),_:1}),a(e(r),{headerClass:"!bg-primary-900",field:"note",header:" Observación"},{body:i(m=>[m.data.HasProblems?(n(),D(e(N),{key:0,icon:"pi pi-eye",onClick:A=>e(d)("observation",m.data),class:"!font-normal !text-primary-900",label:"Ver observación",link:""},null,8,["onClick"])):b("",!0)]),_:1})]),_:1},8,["onOnPage","value","loading"])])):b("",!0),e(h)==="detail"?(n(),D(X,{key:2,visible:e(s),"onUpdate:visible":E[0]||(E[0]=m=>L(s)?s.value=m:null),order:e(_),onVisible:e(l)},null,8,["visible","order","onVisible"])):b("",!0),e(h)==="observation"?(n(),D(Z,{key:3,visible:e(s),"onUpdate:visible":E[1]||(E[1]=m=>L(s)?s.value=m:null),order:e(_),onVisible:e(l)},null,8,["visible","order","onVisible"])):b("",!0),e(c).length===0&&e(o).length===0?(n(),C("div",Ye,We)):b("",!0)],64))}};const Ze={class:"px-3"},ea={key:0,class:"text-center",style:{color:"#259bd7"}},aa=t("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}},null,-1),ta=[aa],ca={__name:"SalesNotes",setup(v){const g=W(),p=f([]),s=f([]),_=f(!1),h=()=>{p.value=g.orders.filter(d=>d.is_managed==!1||d.MethodShippingId===1&&d.is_managed==!1).sort((d,l)=>new Date(l.updated_at)-new Date(d.updated_at)),s.value=g.orders.filter(d=>d.is_managed==!0).sort((d,l)=>new Date(l.updated_at)-new Date(d.updated_at)),_.value=!0};return U(async()=>{await g.getOrdersCda(),h(),B(g.orders,()=>{h()})}),(d,l)=>(n(),C(R,null,[t("div",Ze,[a(e(te),null,{default:i(()=>[a(e(q),{header:"Por gestionar"},{default:i(()=>[_.value?b("",!0):(n(),C("div",ea,ta)),_.value?(n(),D(Fe,{key:1,ListOrders:p.value},null,8,["ListOrders"])):b("",!0)]),_:1}),a(e(q),{header:"Gestionadas"},{default:i(()=>[_.value?(n(),D(Xe,{key:0,ListOrders:s.value},null,8,["ListOrders"])):b("",!0)]),_:1})]),_:1})]),a(e(oe))],64))}};export{ca as default};
